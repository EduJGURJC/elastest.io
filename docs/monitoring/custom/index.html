--- 
layout: default 
title: Elastest Documentation - Custom monitoring 
active: documentation 
section-title: Documentation 
section-icon: mdi mdi-content-copy 
---
<script src="/js/jquery-3.1.1.min.js"></script>
<script src="/js/float-panel.js"></script>

<script type="text/javascript">
	/* Import docs theme css */
	$('head').append('<link rel="stylesheet" type="text/css" href="/css/theme_extra.css">');
	

	$( document).ready(function(){
		$('#menu-list').show();
	    $('li.subnav_drop').find('ul.subnav').hide();
	       $( ".subnav" ).find( "li:contains('Custom monitoring')" ).each(function(i,e){
		  var currentElement = $(e);
		  currentElement.parent().css({"display":"block","visibility":"visible"}); //css("background-color","blue");
		  currentElement.css({"display":"block","visibility":"visible"});
	       });
	    $('li.subnav_drop').click(function(i,e) {  
	      $('li.subnav_drop').not(this).find('ul.subnav').hide();
	      $(this).find('ul.subnav').toggle();
	    }); 

	    var minHeight = $('#float-panel').outerHeight() + 100;	
						$('#doc-container').css('min-height', minHeight+'px');
	});
	   
	$( ".wy-nav-content" ).find( "li:contains('Custom monitoring')" ).css('color','red');
 </script>

<div id="doc-container" class="container text-justify">
  <div class="holder range"> 
        <div id="float-panel" class="wy-grid-for-nav cell-xs-3 cell-md-3 cell-lg-2 float-panel" data-top="56">

          
          <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
            <div class="wy-menu wy-menu-vertical" role="navigation" aria-label="main navigation">
		<div id="site-menu-title">
			<h3 class="h5">Explore docs</h3>
			<hr class="divider hr-lg-left-0 bg-orange">    
		</div>
		<ul id="menu-list" class="current" hidden>
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Getting started</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../..">What is ElasTest?</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../try-elastest/">Try ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../your-first-test/">Your first test with ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../support/">Get support from ElasTest team</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Testing with ElasTest</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/unit/">Run unit tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/e2e-rest/">Run end2end tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/sut/">Software under Test</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/parameterized-tests/">Parameterized tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/multi-configuration-tjobs/">Multi-Configuration TJobs</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Web Browsers</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/manual-browsers/">Launching Web Browsers on ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/e2e-browser/">Run en2end tests with Web Browsers</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/outside-testing/">Testing with Web Browsers from outside ElasTest</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../log-analyzer/">Log Analyzer</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../testlink/">TestLink with ElasTest</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Monitoring</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../">Monitoring</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../outside-elastest/">Monitoring outside Elastest</a>
        
    </li>


        
             

    <li class="toctree-l1 current">
        <a class="current" href="./">Custom monitoring</a>
        
         
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Jenkins</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/">Jenkins integration</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/try-jenkins/">Try Jenkins plugin</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/pipeline/">Pipeline Jobs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/freestyle/">Freestyle Jobs</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Deploying ElasTest</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/ubuntu/">Linux Server</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/aws/">Amazon Web Services</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../testing/environment-variables/">Environment variables</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../releases/">Releases</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../experimental/">Experimental</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../roadmap/">Roadmap</a>
        
    </li>

</ul></li>
				
			
		</ul>
            </div>
            &nbsp;
          </nav>
        </div>

	<section class="section-sm-41">
		<div class="shell">
		    <div class="range range-xs-right">
		        <div class="cell-xs-10 cell-sm-8 cell-md-9 cell-lg-10 cell-xl-12 text-md-left cell-lg-push-1 offset-lg-top-0">
			  
				<div class="wy-nav-content">
				  <div class="rst-content">
				   
				    <div role="main">
				      <div class="section">
					
					  <div class="range range-xs-left">
<div class="cell-xs-10 cell-lg-6 text-md-left inset-md-right-80 cell-lg-push-1 offset-top-50 offset-lg-top-0">
<h2 id="content" class="h1">Custom monitoring</h2>
<div class="offset-top-30 offset-md-top-30">
</div>
</div>
</div>

<p>ElasTest automatically gathers metrics and logs from all TJobs and from all SuTs deployed by the platform itself (dockerized SuTs), as explained <a href="../../monitoring/">here</a>. And ElasTest allows configuring already deployed SuTs for sending metrics and logs thanks to Beats technology, as explained <a href="../../monitoring/outside-elastest/">here</a>. But what if you want to send some custom information to ElasTest to be shown or graphed during a TJob execution? For example:</p>
<ul>
<li>If your SuT is a web application, the code in your TJob can send the number of users connecting to it as it executes so you can compare it with the CPU consumption or memory usage of the SuT.</li>
<li>If you are interested in a specific metric of your SuT for which there's no Beat agent available (<a href="https://www.elastic.co/products/beats">official agents</a> or <a href="https://www.elastic.co/guide/en/beats/libbeat/current/community-beats.html">community agents</a>), you can always send it through http.</li>
</ul>
<p>For this reason, ElasTest allows users to send any log or metric through http requests.</p>
<h4 id="send-metrics-with-http" class="holder-subtitle link-top">Send metrics with HTTP</h4>

<p>You can send to ElasTest metric information with http requests from any TJob or any SuT.</p>
<h5 class="small-subtitle">IP of http request in a TJob or a SuT deployed by ElasTest</h5>

<p>Value of environment variable <em><code>ET_MON_LSHTTP_API</code></em>.</p>
<h5 class="small-subtitle">IP of http request in a SuT deployed outside ElasTest</h5>

<p>The URL can be built with <strong>HTTP Api Url</strong> param, available from the SuT information page:</p>
<div class="docs-gallery more-margin-top inline-block">
    <a data-fancybox="gallery-2" href="/docs/monitoring/images/logstash_ip.png"><img class="img-responsive img-wellcome" src="/docs/monitoring/images/logstash_ip.png"/></a>
</div>

<p>For to the image above, the URL where to send the post requests would be:</p>
<pre><code class="text">http://172.18.0.11:80/logstash/
</code></pre>

<p><br></p>
<p>The request has to use the POST method. There are different formats to send different types of information:</p>
<h5 class="small-subtitle">Send one log entry in one request</h5>

<pre><code class="json">{
   &quot;@timestamp&quot;: 9999999999,
   &quot;exec&quot;: &quot;XX&quot;,
   &quot;component&quot;: &quot;YY&quot;,
   &quot;stream&quot;: &quot;ZZ&quot;,
   &quot;message&quot;: &quot;Complete log message entry&quot;
}
</code></pre>

<div style="margin-top: 20px"></div>

<ul>
<li><strong>@timestamp</strong>: is optional and contains the timestamp when event was generated.</li>
<li><strong>exec</strong>: The value of <strong>Exec ID</strong> shown in ElasTest dashboard for SuTs deployed outside ElasTest or the value of <code>ET_MON_EXEC</code> environment variable for TJobs or SuTs deployed by ElasTest.</li>
<li><strong>component</strong>: <code>sut</code> for http requests sent from the SuT and <code>test</code> for http requests sent from the TJob.</li>
<li><strong>stream</strong>: Used to distinguish several logs from the same component. In this case only one log exists for the component, its value is usually "default_log".</li>
<li><strong>message</strong>: Complete log message entry.</li>
</ul>
<h5 class="small-subtitle">Send several log entries in one request</h5>

<pre><code class="json">{
   &quot;@timestamp&quot;: 9999999999,
   &quot;exec&quot;: &quot;XX&quot;,
   &quot;component&quot;: &quot;YY&quot;,
   &quot;stream&quot;: &quot;ZZ&quot;,
   &quot;messages&quot;: [
      &quot;Complete log message entry 1&quot;,
      &quot;Complete log message entry 2&quot;,
      &quot;Complete log message entry 3&quot;,
      &quot;Complete log message entry 4&quot;
   ]
}
</code></pre>

<h5 class="small-subtitle">Send one atomic metric in one request</h5>

<pre><code class="json">{
   &quot;@timestamp&quot;: 9999999999,
   &quot;exec&quot;: &quot;XX&quot;,
   &quot;component&quot;: &quot;YY&quot;,
   &quot;stream&quot;: &quot;cpu_usage&quot;,
   &quot;stream_type&quot;: &quot;atomic_metric&quot;,
   &quot;cpu_usage&quot;: 80,
   &quot;unit&quot;: &quot;%&quot;
}
</code></pre>

<div style="margin-top: 20px"></div>

<ul>
<li><strong>stream</strong> field can be whatever you want (it has to be used below when setting the numeric value)</li>
</ul>
<h5 class="small-subtitle">Send one composed metric in one request</h5>

<pre><code class="json">{
   &quot;@timestamp&quot;: 9999999999,
   &quot;exec&quot;: &quot;XX&quot;,
   &quot;component&quot;: &quot;YY&quot;,
   &quot;et_type&quot;: &quot;cpu&quot;,
   &quot;stream_type&quot;: &quot;composed_metric&quot;,
   &quot;cpu&quot;: {
     &quot;total_usage&quot;: 80,
     &quot;max_usage&quot;: 100
   }
   &quot;units&quot;: {
     &quot;total_usage&quot;: &quot;%&quot;,
     &quot;max_usage&quot;: &quot;%&quot;
   }
}
</code></pre>
					
				      </div>
				    </div>
				    <footer>
<hr class="divider divider-100 divider-xs hr-lg-center-0 offset-xs-top-20 offset-sm-top-20 offset-md-top-20 offset-lg-top-20">
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../jenkins/" class="btn btn-xs btn-primary float-right" title="Jenkins integration">Next &raquo;<span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../outside-elastest/" class="btn btn-xs btn-primary" title="Monitoring outside Elastest"><span class="icon icon-circle-arrow-left"></span> &laquo; Prev</a>
      
    </div>
  


  
  
	  <a href="https://github.com/elastest/elastest.io-docs/blob/master/docs/monitoring/custom.md" class="fa fa-github offset-xxs-top-30"> Edit Documentation on GitHub</a>
  
</footer>
			  	  
				  </div>
				</div>
			</div>
		    </div>
		</div>
	</section>

  </div>
</div>

<!-- Gallery -->
<script src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js"></script>

<script>
var galleries = $('div.docs-gallery');
for (var i = 1; i <= galleries.length; i++) {
    $().fancybox({
    selector : '[data-fancybox="gallery-' + i + '"]',
    infobar : true,
    arrows : false,
    loop: false,
    protect: true,
    transitionEffect: 'slide',
    buttons : [
        'close'
    ],
    clickOutside : 'close',
    clickSlide   : 'close',
  });
}
</script>
