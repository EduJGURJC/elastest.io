--- 
layout: default 
title: Elastest Documentation - Kubernetes 
active: documentation 
section-title: Documentation 
section-icon: mdi mdi-content-copy 
---
<script src="/js/jquery-3.1.1.min.js"></script>
<script src="/js/float-panel.js"></script>

<script type="text/javascript">
	/* Import docs theme css */
	$('head').append('<link rel="stylesheet" type="text/css" href="/css/theme_extra.css">');
	

	$( document).ready(function(){
		$('#menu-list').show();
	    $('li.subnav_drop').find('ul.subnav').hide();
	       $( ".subnav" ).find( "li:contains('Kubernetes')" ).each(function(i,e){
		  var currentElement = $(e);
		  currentElement.parent().css({"display":"block","visibility":"visible"}); //css("background-color","blue");
		  currentElement.css({"display":"block","visibility":"visible"});
	       });
	    $('li.subnav_drop').click(function(i,e) {  
	      $('li.subnav_drop').not(this).find('ul.subnav').hide();
	      $(this).find('ul.subnav').toggle();
	    }); 

	    var minHeight = $('#float-panel').outerHeight() + 100;	
						$('#doc-container').css('min-height', minHeight+'px');
	});
	   
	$( ".wy-nav-content" ).find( "li:contains('Kubernetes')" ).css('color','red');
 </script>

<div id="doc-container" class="container text-justify">
  <div class="holder range"> 
        <div id="float-panel" class="wy-grid-for-nav cell-xs-3 cell-md-3 cell-lg-2 float-panel" data-top="56">

          
          <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
            <div class="wy-menu wy-menu-vertical" role="navigation" aria-label="main navigation">
		<div id="site-menu-title">
			<h3 class="h5">Explore docs</h3>
			<hr class="divider hr-lg-left-0 bg-orange">    
		</div>
		<ul id="menu-list" class="current" hidden>
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../..">What is ElasTest?</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Tutorials</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../getting-started/">Getting started</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../e2e-testing/">E2E Testing in ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-browsers-in-elastest/">Using browsers in ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-eds-devices-for-iot/">Using EDS devices for IoT</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-ems-to-build-tests-with-dynamic-info/">Using EMS to build tests with dynamic info</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-ess-to-perform-security-checks/">Using ESS to perform security checks</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../custom-metrics/">Custom metrics</a>
        
    </li>


        
             

    <li class="toctree-l1 current">
        <a class="current" href="./">Kubernetes</a>
        
         
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../ere-with-custom-code/">ERE with custom code</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-ebs-to-perform-analytics/">Using EBS to perform analytics</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../estimating-the-costs-of-tests-on-aws/">Estimating the costs of tests on AWS</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../observability-for-5g-infrastructures/">Observability for 5G infrastructures</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../ems/">EMS (show how specific visualizations for TJobs and ElasTest TSS work)</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Demos</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/api-testing/">API testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/e2e-testing/">E2E testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/functional-exploratory-testing/">Functional / Exploratory testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/multi-configuration/">Multi-configuration</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/load-testing-with-aws/">Load testing with AWS</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/cross-browser-testing/">Cross browser testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/security-testing/">Security testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/chaos-testing/">Chaos testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/qoe/">QoE testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/test-recommendation/">Test recommendation</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/test-cost-estimation/">Test cost estimation</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Cheatsheet</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../try-elastest/">Try ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/unit/">Run unit tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/e2e-rest/">Run end2end tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/sut/">Software under Test</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/parameterized-tests/">Parameterized tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/multi-configuration-tjobs/">Multi-Configuration TJobs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/manual-browsers/">Launching Web Browsers on ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/e2e-browser/">Run en2end tests with Web Browsers</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/outside-testing/">Testing with Web Browsers from outside ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../log-analyzer/">Log Analyzer</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../executions-comparator/">Executions Comparator</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testlink/">TestLink with ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../monitoring/">Test Monitoring</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../monitoring/outside-elastest/">Monitoring outside Elastest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../monitoring/custom/">Custom monitoring</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/pipeline/">Pipeline Jobs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/freestyle/">Freestyle Jobs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../roadmap/">Roadmap</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Reference documentation</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/environment-variables/">Enviroment variables</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ems/">Elastest Monitoring Service (EMS)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ece/">Elastest Cost Engine (ECE)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ere-trial/">Elastest Recommendation Egine (ERE)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ebs/">ElasTest BigData Service (EBS)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/eds/">ElasTest Device impersonation Service (EDS - IoT)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ess/">ElasTest Security Service (ESS)</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Deployment</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/ubuntu/">Linux Server</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/aws/">Amazon Web Services</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/kubernetes/">Kubernetes</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Management</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../elastest-monitoring/">Monitoring ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../manage-elastest/monitoring-containers/">Monitoring containers</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../manage-elastest/manage-elasticsearch/">Monitoring ElasticSearch</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../releases/">Releases</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../support/">Support</a>
        
    </li>

</ul></li>
				
			
		</ul>
            </div>
            &nbsp;
          </nav>
        </div>

	<section class="section-sm-41">
		<div class="shell">
		    <div class="range range-xs-right">
		        <div class="cell-xs-10 cell-sm-8 cell-md-9 cell-lg-10 cell-xl-12 text-md-left cell-lg-push-1 offset-lg-top-0">
			  
				<div class="wy-nav-content">
				  <div class="rst-content">
				   
				    <div role="main">
				      <div class="section">
					
					  <div class="range range-xs-left">
<div class="cell-xs-10 cell-lg-6 text-md-left inset-md-right-80 cell-lg-push-1 offset-top-50 offset-lg-top-0">
<h2 id="content" class="h1">Kubernetes</h2>
<div class="offset-top-30 offset-md-top-30">
</div>
</div>
</div>

<h4 class="small-subtitle">What do I need to run jenkins jobs at ElasTest with Kubernetes?</h4>

<p>If you have already used <em>ElasTest with docker</em> and have run Jenkins jobs there are only a few small changes, if not, check out <a href="/docs/tutorials/e2e-testing/">this documentation</a> to see how to configure the <strong>ElasTest plugin</strong> for Jenkins.</p>
<p>Once you have configured the ElasTest plugin and modified your Job's pipeline, all you have to do is <strong>follow these steps</strong>:</p>
<ul>
<li>Install <a href="https://github.com/jenkinsci/kubernetes-cli-plugin">Kubernetes CLI Plugin</a></li>
<li>
<p>Modify your pipeline script to add this block just below the elastest block:</p>
<p>withKubeConfig([credentialsId: 'k8s-api-token', serverUrl: env.K8S_URL]) {</p>
<p>Your pipeline will look like this:</p>
<pre><code>    elastest(...) {
        withKubeConfig([credentialsId: 'k8s-api-token', serverUrl: env.K8S_URL]) {
            ...
        }
    }
</code></pre>
</li>
</ul>
<h4 class="small-subtitle">Running a Demo Job</h4>

<p>The <strong>Jenkins instance provided by ElasTest</strong> offers by default several example Jobs to run with Kubernetes. Let's see the pipeline script of one of them, <strong><code>jenkins-junit5-multi-browser-test-on-k8s</code></strong>:</p>
<pre><code>node {
    elastest(tss: ['EUS'], surefireReportsPattern: '**/target/surefire-reports/TEST-*.xml', project: 'Jenkins Examples') {
        withKubeConfig([credentialsId: 'k8s-api-token', serverUrl: env.K8S_URL]) {
            try {
                stage(&quot;Start SUT&quot;) {
                    git(
                        url: 'https://github.com/elastest/demo-projects'
                        )
                    sh &quot;cd ./webapp/junit5-web-multiple-browsers-test/k8s;./addSutPrefix.sh;kubectl create -f .&quot;
                    checkPodStatus(1, &quot;${ET_SUT_CONTAINER_NAME}-demo-web-java-sut&quot;)
                }

                stage(&quot;Run tests&quot;) {
                    mvnHome = tool 'M3.3.9'
                    def sutIp = getPodIp('demo-web-java-sut')
                    waitForService(5, &quot;http://&quot; + sutIp + &quot;:8080&quot;)
                    withEnv(['ET_SUT_HOST=' + sutIp]) {
                        echo &quot;Running test&quot;
                        sh &quot;cd ./webapp/junit5-web-multiple-browsers-test/;'${mvnHome}/bin/mvn' -Dbrowser=chrome -DforkCount=0 test&quot;
                    }
                }

            } finally {
                sh &quot;cd ./webapp/junit5-web-multiple-browsers-test/;kubectl delete -f k8s/&quot;
                junit &quot;target/*-reports/TEST-*.xml&quot;
            }
        }
    }
}

def getPodIp(podName) {
    echo &quot;Retrive pod ip&quot;
    def podIp = sh (
        script: &quot;kubectl get pod -o wide | grep &quot; + podName + &quot; | awk '{print \$6}'&quot;,
        returnStdout: true
    ).split( '\n' ).first()

    echo podName+&quot; IP = &quot; + podIp;
    return podIp;
}

def waitForService(time, serviceUrl) {
    timeout(time) {
        waitUntil {
            echo &quot;Waiting for the service &quot; + serviceUrl + &quot; is ready&quot;
            script {
                def r = sh script: 'wget -q ' + serviceUrl + ' -O /dev/null', returnStatus: true
                return (r == 0);
           }
        }
    }
}

def checkPodStatus(time, podName) {
    timeout(time) {
        waitUntil {
            echo &quot;Waiting for the pod &quot; + podName + &quot; is created&quot;
            script {
                def r = sh script: 'kubectl get pods -l io.elastest.service=' + podName.replace('_','-') + &quot; | awk '{print \$3}'&quot;, returnStdout: true
                def status = r.split(&quot;\n&quot;).last()
                echo &quot;Pod ${podName} current status: &quot; + status
                return ( status == 'Running');
           }
        }
    }
}
</code></pre>

<p>Let's look at a few lines in detail:</p>
<ul>
<li>
<p><strong>ElasTest configuration</strong>: This Job executes a E2E test. For this make use of EUS to start browsers</p>
<pre><code>      elastest(tss: ['EUS'], surefireReportsPattern: '**/target/surefire-reports/TEST-*.xml', project: 'Jenkins Examples') {
          ...
      }
</code></pre>
</li>
<li>
<p>The <strong>Kubernetes config</strong> block:</p>
<pre><code>      withKubeConfig([credentialsId: 'k8s-api-token', serverUrl: env.K8S_URL]) {
          ...
      }
</code></pre>
</li>
<li>
<p>Start and wait for <strong>Sut</strong>: This Job starts a Sut via Kubernetes using a yaml file.</p>
<pre><code>      git(
          url: 'https://github.com/elastest/demo-projects'
          )
      sh "cd ./webapp/junit5-web-multiple-browsers-test/k8s;./addSutPrefix.sh;kubectl create -f ."
</code></pre>
<p>Then waits until the Sut pod is created:</p>
<pre><code>      checkPodStatus(1, "${ET_SUT_CONTAINER_NAME}-demo-web-java-sut")
</code></pre>
<p>After, gets the ip of the Sut and waits until the Sut is ready:</p>
<pre><code>      def sutIp = getPodIp('demo-web-java-sut')
      waitForService(5, "http://" + sutIp + ":8080")
</code></pre>
</li>
<li>
<p><strong>Run tests</strong>:</p>
<pre><code>      withEnv(['ET_SUT_HOST=' + sutIp]) {
          echo "Running test"
          sh "cd ./webapp/junit5-web-multiple-browsers-test/;'${mvnHome}/bin/mvn' -Dbrowser=chrome -DforkCount=0 test"
      }
</code></pre>
</li>
</ul>
<h5 id="running-job">Running Job</h5>
<p>You can <strong><code>run the Job</code></strong> and <strong>navigate to ElasTest</strong> to view it. You can easily access it from the Jenkins run console:</p>
<div class="docs-gallery inline-block">
    <a data-fancybox="gallery-2" href="/docs/tutorials/images/kubernetes/openInElastest.png"><img class="img-responsive img-wellcome" src="/docs/tutorials/images/kubernetes/openInElastest.png"/></a>
</div>

<p>This test suite has <strong>3 test cases</strong>, of which 2 finish correctly and <strong><code>1 of them fails</code></strong>. Once the execution is finished you can <strong>view all the information in ElasTest</strong>:</p>
<div class="docs-gallery inline-block">
    <a data-fancybox="gallery-2" href="/docs/tutorials/images/kubernetes/executionInElastest.png"><img class="img-responsive img-wellcome" src="/docs/tutorials/images/kubernetes/executionInElastest.png"/></a>
</div>
					
				      </div>
				    </div>
				    <footer>
<hr class="divider divider-100 divider-xs hr-lg-center-0 offset-xs-top-20 offset-sm-top-20 offset-md-top-20 offset-lg-top-20">
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ere-with-custom-code/" class="btn btn-xs btn-primary float-right" title="ERE with custom code">Next &raquo;<span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../custom-metrics/" class="btn btn-xs btn-primary" title="Custom metrics"><span class="icon icon-circle-arrow-left"></span> &laquo; Prev</a>
      
    </div>
  


  
  
	  <a href="https://github.com/elastest/elastest.io-docs/blob/master/docs/tutorials/kubernetes.md" class="fab fa-github offset-xxs-top-30"> Edit Documentation on GitHub</a>
  
</footer>
			  	  
				  </div>
				</div>
			</div>
		    </div>
		</div>
	</section>

  </div>
</div>

<!-- Gallery -->
<script src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js"></script>

<script>
var galleries = $('div.docs-gallery');
for (var i = 1; i <= galleries.length; i++) {
    $().fancybox({
    selector : '[data-fancybox="gallery-' + i + '"]',
    infobar : true,
    arrows : false,
    loop: false,
    protect: true,
    transitionEffect: 'slide',
    buttons : [
        'close'
    ],
    clickOutside : 'close',
    clickSlide   : 'close',
  });
}
</script>
