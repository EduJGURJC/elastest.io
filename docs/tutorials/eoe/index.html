--- 
layout: default 
title: Elastest Documentation - Orchestration testing 
active: documentation 
section-title: Documentation 
section-icon: mdi mdi-content-copy 
---
<script src="/js/jquery-3.1.1.min.js"></script>
<script src="/js/float-panel.js"></script>

<script type="text/javascript">
	/* Import docs theme css */
	$('head').append('<link rel="stylesheet" type="text/css" href="/css/theme_extra.css">');
	

	$( document).ready(function(){
		$('#menu-list').show();
	    $('li.subnav_drop').find('ul.subnav').hide();
	       $( ".subnav" ).find( "li:contains('Orchestration testing')" ).each(function(i,e){
		  var currentElement = $(e);
		  currentElement.parent().css({"display":"block","visibility":"visible"}); //css("background-color","blue");
		  currentElement.css({"display":"block","visibility":"visible"});
	       });
	    $('li.subnav_drop').click(function(i,e) {  
	      $('li.subnav_drop').not(this).find('ul.subnav').hide();
	      $(this).find('ul.subnav').toggle();
	    }); 

	    var minHeight = $('#float-panel').outerHeight() + 100;	
						$('#doc-container').css('min-height', minHeight+'px');
	});
	   
	$( ".wy-nav-content" ).find( "li:contains('Orchestration testing')" ).css('color','red');
 </script>

<div id="doc-container" class="container text-justify">
  <div class="holder range"> 
        <div id="float-panel" class="wy-grid-for-nav cell-xs-3 cell-md-3 cell-lg-2 float-panel" data-top="56">

          
          <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
            <div class="wy-menu wy-menu-vertical" role="navigation" aria-label="main navigation">
		<div id="site-menu-title">
			<h3 class="h5">Explore docs</h3>
			<hr class="divider hr-lg-left-0 bg-orange">    
		</div>
		<ul id="menu-list" class="current" hidden>
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../..">What is ElasTest?</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Tutorials</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../getting-started/">Getting started</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../e2e-testing/">E2E Testing in ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-browsers-in-elastest/">Using browsers in ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-eds-devices-for-iot/">Using EDS devices for IoT</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-ems-to-build-tests-with-dynamic-info/">Using EMS to build tests with dynamic info</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-ess-to-perform-security-checks/">Using ESS to perform security checks</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../custom-metrics/">Custom metrics</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../kubernetes/">Kubernetes</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../ere-with-custom-code/">ERE with custom code</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../using-ebs-to-perform-analytics/">Using EBS to perform analytics</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../estimating-the-costs-of-tests-on-aws/">Estimating the costs of tests on AWS</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../observability-for-5g-infrastructures/">Observability for 5G infrastructures</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../ems/">EMS (show how specific visualizations for TJobs and ElasTest TSS work)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../qoe/">Measuring video quality for video streaming applications</a>
        
    </li>


        
             

    <li class="toctree-l1 current">
        <a class="current" href="./">Orchestration testing</a>
        
         
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Demos</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/api-testing/">API testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/e2e-testing/">E2E testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/functional-exploratory-testing/">Functional / Exploratory testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/multi-configuration/">Multi-configuration</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/load-testing-with-aws/">Load testing with AWS</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/cross-browser-testing/">Cross browser testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/security-testing/">Security testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/chaos-testing/">Chaos testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/qoe/">QoE testing</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/test-recommendation/">Test recommendation</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../demos/test-cost-estimation/">Test cost estimation</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Cheatsheet</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../try-elastest/">Try ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/unit/">Run unit tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/e2e-rest/">Run end2end tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/sut/">Software under Test</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/parameterized-tests/">Parameterized tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/multi-configuration-tjobs/">Multi-Configuration TJobs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/manual-browsers/">Launching Web Browsers on ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/e2e-browser/">Run en2end tests with Web Browsers</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/outside-testing/">Testing with Web Browsers from outside ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../log-analyzer/">Log Analyzer</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../executions-comparator/">Executions Comparator</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testlink/">TestLink with ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../monitoring/">Test Monitoring</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../monitoring/outside-elastest/">Monitoring outside Elastest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../monitoring/custom/">Custom monitoring</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/pipeline/">Pipeline Jobs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/freestyle/">Freestyle Jobs</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../roadmap/">Roadmap</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Reference documentation</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/environment-variables/">Enviroment variables</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ems/">Elastest Monitoring Service (EMS)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ece/">Elastest Cost Engine (ECE)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ere-trial/">Elastest Recommendation Egine (ERE)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ebs/">ElasTest BigData Service (EBS)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/eds/">ElasTest Device impersonation Service (EDS - IoT)</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../test-services/ess/">ElasTest Security Service (ESS)</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Deployment</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/ubuntu/">Linux Server</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/aws/">Amazon Web Services</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/kubernetes/">Kubernetes</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Management</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../elastest-monitoring/">Monitoring ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../manage-elastest/monitoring-containers/">Monitoring containers</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../manage-elastest/manage-elasticsearch/">Monitoring ElasticSearch</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../releases/">Releases</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../support/">Support</a>
        
    </li>

</ul></li>
				
			
		</ul>
            </div>
            &nbsp;
          </nav>
        </div>

	<section class="section-sm-41">
		<div class="shell">
		    <div class="range range-xs-right">
		        <div class="cell-xs-10 cell-sm-8 cell-md-9 cell-lg-10 cell-xl-12 text-md-left cell-lg-push-1 offset-lg-top-0">
			  
				<div class="wy-nav-content">
				  <div class="rst-content">
				   
				    <div role="main">
				      <div class="section">
					
					  <div class="range range-xs-left">
<div class="cell-xs-10 cell-lg-6 text-md-left inset-md-right-80 cell-lg-push-1 offset-top-50 offset-lg-top-0">
<h2 id="content" class="h1">Test Orchestration with EOE (ElasTest Orchestrator Engine)</h2>
<div class="offset-top-30 offset-md-top-30">
</div>
</div>
</div>

<h3 class="small-subtitle" id="eoe">ElasTest Orchestrator Engine (EOE)</h3>

<p>The <a href="https://github.com/elastest/elastest-orchestration-engine" target="_blank">ElasTest Orchestration Engine (EOE)</a> is the component responsible of implementing the concept of orchestration within Elastest, understood as a novel way to select, order, and execute a group of TJobs.</p>
<p>To that aim, we have leveraged the pipelines Jenkins notation for the topology generation by means of a [Jenkins shared library]. This library exposes a simple API to orchestrate testing jobs. The orchestrator library API is summarized in the following table:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>runJob(String jobId)</code></strong></td>
<td>Method to run a job given its identifier (<em>jobId</em>).This method returns a boolean value: <strong><code>true</code></strong> if the execution of the job finishes correctly and <strong><code>false</code></strong> if fails</td>
</tr>
<tr>
<td><strong><code>runJobDependingOn(boolean verdict, String job1Id, String job2Id)</code></strong></td>
<td>Method allows to run one job given a boolean value (typically a verdict from another job). This boolean value is passes in the first argument (called verdict in the method signature). If this value job with identifier <code>job1Id</code> is executed. Otherwise it is executed <strong><code>job2Id</code></strong></td>
</tr>
<tr>
<td><strong><code>runJobsInParallel(String... jobs)</code></strong></td>
<td>This method allows to run a set of jobs in parallel. The jobs identifier are passes using a variable number of arguments (<em>varargs</em>)</td>
</tr>
</tbody>
</table>
<p>Moreover, the exit condition for the orchestrated job can be also configured:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>EXIT_AT_END</code></strong></td>
<td>The orchestration finishes at the end (option by default)</td>
</tr>
<tr>
<td><strong><code>EXIT_ON_FAIL</code></strong></td>
<td>The orchestration finishes when any of the TJobs fail</td>
</tr>
<tr>
<td><strong><code>EXIT_ON_PARALLEL_FAILURE</code></strong></td>
<td>The orchestration finishes when any a set of parallel TJobs fail</td>
</tr>
</tbody>
</table>
<p>Finally, the verdict of a group of parallel jobs can be also configured:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>AND</code></strong></td>
<td>The verdict of a set of jobs executed in parallel is <strong><code>true</code></strong> only if all the jobs finish correctly</td>
</tr>
<tr>
<td><strong><code>OR</code></strong></td>
<td>The verdict of parallel jobs is <strong><code>true</code></strong> when at least one of the jobs finishes correctly</td>
</tr>
</tbody>
</table>
<p>Other configurations:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
<th>Use Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>setPacketLoss</code></strong></td>
<td>If a SuT instrumented By ElasTest through EIM is used, one or more packet loss values can be set. If more than one is specified, the job will be run as many times as there are values.</td>
<td>setPacketLoss(['0.01', '0.02'])</td>
</tr>
<tr>
<td><strong><code>setCpuBurst</code></strong></td>
<td>If a SuT instrumented By ElasTest through EIM is used, one or more cpu burst (stress) values can be set. If more than one is specified, the job will be run as many times as there are values.</td>
<td>setCpuBurst(['0.2'])</td>
</tr>
<tr>
<td><strong><code>checkTime</code></strong></td>
<td>Allows to check if an execution lasts less (LessThan) or more (GreaterThan) than the indicated time (In milliseconds, seconds, minutes, etc.).</td>
<td>checkTime(Compare.LessThan, 60, TimeUnit.SECONDS)</td>
</tr>
</tbody>
</table>
<p>At the moment, only packet loss and cpu burst can be set separately, so the two cannot be set at the same time.</p>
<h2 id="how-to-install">How to install</h2>
<ul>
<li>Navigate to <strong>Manage Jenkins</strong> in your Jenkins.</li>
<li>Click to <strong>System Configuration</strong></li>
<li>Add new library in <strong>Global Pipeline Libraries</strong> with name <strong>OrchestrationLib</strong> and default version <strong>master</strong></li>
<li>Select <strong>Modern SCM</strong></li>
<li>Select <strong>GitHub</strong></li>
<li>Owner: <strong>elastest</strong></li>
<li>Repository: <strong>elastest-orchestration-engine</strong></li>
<li>Save changes</li>
</ul>
<h3 class="small-subtitle" id="eoe-tutorial">QoE testing using EOE</h3>

<p>The first thing you must do is <strong><code>create an instance of OpenVidu in AWS</code></strong>, which will be the SuT we will use.</p>
<p>To do this, you must use <a href="https://github.com/elastest/codeurjc-qe-openvidu/blob/master/src/test/resources/openvidu-sut.yml">this file for CloudFormation</a> and wait for the instance to start completely.</p>
<p>The next thing you do is <strong><code>create a new project in ElasTest</code></strong> with the name you want. Let's assume it's called Jenkins Examples. Within this project you must <strong><code>create a new Sut</code></strong> with the following configuration:</p>
<ul>
<li><strong>SuT Name:</strong> Whatever you want, for example <strong>OpenVidu AWS</strong></li>
<li>Select "<strong>Deployed outside Elastest</strong>" and "<strong>Instrumented by ElasTest</strong>"</li>
<li><strong>SuT IP:</strong> the ip of the AWS instance</li>
<li><strong>Protocol:</strong> https</li>
<li><strong>Port:</strong> 4443</li>
<li><strong>User:</strong> ubuntu</li>
<li><strong>Password:</strong> 1234</li>
<li><strong>Private Key:</strong> the private key to connect to the instance. (-----BEGIN RSA PRIVATE KEY-----...)</li>
<li><strong>Instrumentalize:</strong> cheked</li>
<li><strong>SuT Logs Paths:</strong><ul>
<li>/var/log/openvidu.log</li>
<li>/var/log/kurento-media-server/*.log</li>
</ul>
</li>
<li>Save</li>
</ul>
<p>Once this is done, you must <strong>go to the Jenkins</strong> section to start and access Jenkins. In Jenkins, the first thing you should do if you haven't done it before is to configure the EOE library as indicated in this documentation.</p>
<p>You must now <strong><code>create a new Pipeline Job</code></strong> with the following settings:</p>
<ul>
<li><strong>Name:</strong>  Whatever you want, for example <strong>quality-of-experience</strong></li>
<li><strong>Parameters:</strong><ul>
<li><strong>Name:</strong> AWS_ACCESS_KEY_ID <strong>| Value:</strong> your AWS access key id</li>
<li><strong>Name:</strong> AWS_SECRET_ACCESS_KEY <strong>| Value:</strong> your AWS secret access key</li>
<li><strong>Name:</strong> AWS_KEY_NAME <strong>| Value:</strong> your AWS key name</li>
<li><strong>Name:</strong> AWS_SSH_PRIVATE_KEY <strong>| Value:</strong> your AWS private key. <em>It's important that you replace line breaks with <strong>\r\n</strong> literal</em></li>
<li><strong>Name:</strong> AWS_SECURITY_GROUPS <strong>| Value:</strong> your AWS security group with the following format -&gt; ["securitygroupname"]</li>
<li><strong>Name:</strong> ET_MON_LSHTTPS_API <strong>| Value:</strong> http://etm:5003/api/monitoring/</li>
</ul>
</li>
<li><strong>Pipeline script:</strong><ul>
<li>In the following script you need to <strong>replace the sut value</strong> (<em>SUTIDHERE</em>) with the sut id you created earlier.</li>
<li>You'll also have to <strong>replace the project name</strong> if you put in another name other than <em>Jenkins Examples</em><pre><code>node{
    elastest(tss: ['EUS'], surefireReportsPattern: '**/target/surefire-reports/TEST-*.xml', project: 'Jenkins Examples', sut: SUTIDHERE) {
        stage ('Executing Test') {
            sh 'env'
            echo 'Set up test environment'
            mvnHome = tool 'M3.3.9'
            echo 'Cloning repository'
            git 'https://github.com/elastest/codeurjc-qe-openvidu'
            echo 'Run test'
            sh "'${mvnHome}/bin/mvn' -B -DforkCount=0 test -Dtest=OpenviduWebRTCQoEMeterAWS;"
            sh "sleep 20"
            step([$class: 'JUnitResultArchiver', testResults: '**/target/surefire-reports/TEST-*.xml'])

        }        
    }
}
</code></pre>
</li>
</ul>
</li>
</ul>
<p>Now <strong><code>create another pipeline job</code></strong> which will define the orchestration:</p>
<ul>
<li><strong>Name:</strong>  Whatever you want, for example <strong>eoe</strong></li>
<li><strong>Pipeline script</strong><ul>
<li>If you put a different quality-of-experience name to the previous pipeline, replace it in the last line<pre><code>@Library('OrchestrationLib') _
orchestrator.setContext(this)
orchestrator.setExitCondition(OrchestrationExitCondition.EXIT_ON_FAIL)

orchestrator.setPacketLoss(['0.20','0.40'])

// Graph
def result = orchestrator.runJob('quality-of-experience')
</code></pre>
</li>
</ul>
</li>
</ul>
<p>Run eoe and enjoy!</p>
					
				      </div>
				    </div>
				    <footer>
<hr class="divider divider-100 divider-xs hr-lg-center-0 offset-xs-top-20 offset-sm-top-20 offset-md-top-20 offset-lg-top-20">
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../demos/api-testing/" class="btn btn-xs btn-primary float-right" title="API testing">Next &raquo;<span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../qoe/" class="btn btn-xs btn-primary" title="Measuring video quality for video streaming applications"><span class="icon icon-circle-arrow-left"></span> &laquo; Prev</a>
      
    </div>
  


  
  
	  <a href="https://github.com/elastest/elastest.io-docs/blob/master/docs/tutorials/eoe.md" class="fab fa-github offset-xxs-top-30"> Edit Documentation on GitHub</a>
  
</footer>
			  	  
				  </div>
				</div>
			</div>
		    </div>
		</div>
	</section>

  </div>
</div>

<!-- Gallery -->
<script src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js"></script>

<script>
var galleries = $('div.docs-gallery');
for (var i = 1; i <= galleries.length; i++) {
    $().fancybox({
    selector : '[data-fancybox="gallery-' + i + '"]',
    infobar : true,
    arrows : false,
    loop: false,
    protect: true,
    transitionEffect: 'slide',
    buttons : [
        'close'
    ],
    clickOutside : 'close',
    clickSlide   : 'close',
  });
}
</script>
