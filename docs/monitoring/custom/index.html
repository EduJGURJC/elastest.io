--- 
layout: default 
title: Elastest Documentation - Custom monitoring 
active: documentation 
section-title: Documentation 
section-icon: mdi mdi-content-copy 
---
<script src="/js/jquery-3.1.1.min.js"></script>
<script src="/js/float-panel.js"></script>

<script type="text/javascript">
	/* Import docs theme css */
	$('head').append('<link rel="stylesheet" type="text/css" href="/css/theme_extra.css">');
	

	$( document).ready(function(){
		$('#menu-list').show();
	    $('li.subnav_drop').find('ul.subnav').hide();
	       $( ".subnav" ).find( "li:contains('Custom monitoring')" ).each(function(i,e){
		  var currentElement = $(e);
		  currentElement.parent().css({"display":"block","visibility":"visible"}); //css("background-color","blue");
		  currentElement.css({"display":"block","visibility":"visible"});
	       });
	    $('li.subnav_drop').click(function(i,e) {  
	      $('li.subnav_drop').not(this).find('ul.subnav').hide();
	      $(this).find('ul.subnav').toggle();
	    }); 

	    var minHeight = $('#float-panel').outerHeight() + 100;	
						$('#doc-container').css('min-height', minHeight+'px');
	});
	   
	$( ".wy-nav-content" ).find( "li:contains('Custom monitoring')" ).css('color','red');
 </script>

<div id="doc-container" class="container text-justify">
  <div class="holder range"> 
        <div id="float-panel" class="wy-grid-for-nav cell-xs-3 cell-md-3 cell-lg-2 float-panel" data-top="56">

          
          <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
            <div class="wy-menu wy-menu-vertical" role="navigation" aria-label="main navigation">
		<div id="site-menu-title">
			<h3 class="h5">Explore docs</h3>
			<hr class="divider hr-lg-left-0 bg-orange">    
		</div>
		<ul id="menu-list" class="current" hidden>
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Getting started</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../..">What is ElasTest?</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../try-elastest/">Try ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../your-first-test/">Your first test with ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../support/">Get support from ElasTest team</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Testing with ElasTest</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/unit/">Run unit tests</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../testing/e2e-rest/">Run end2end tests</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Web Browsers</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/manual-browsers/">Launching Web Browsers on ElasTest</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/e2e-browser/">Run en2end tests with Web Browsers</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../web-browsers/outside-testing/">Testing with Web Browsers from outside ElasTest</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../log-analyzer/">Log Analyzer</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Monitoring</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../">Intro</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../dockerized/">Dockerized monitoring</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../deployed/">Deployed monitoring</a>
        
    </li>


        
             

    <li class="toctree-l1 current">
        <a class="current" href="./">Custom monitoring</a>
        
         
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../gui/">Monitoring user interface</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
				
					<li><ul> 

    <li class="toctree-l1 ">
        <a class="" href="../../jenkins/">Jenkins integration</a>
        
    </li>

</ul></li>
				
			
				
					<li><ul> 
    
   
    <li class="subnav_drop"><span>Deploying ElasTest</span>
<ul class="subnav">
        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/aws/">Amazon Web Services</a>
        
    </li>


        
             

    <li class="toctree-l1 ">
        <a class="" href="../../deploying/ubuntu/">Ubuntu</a>
        
    </li>


        
</li>
</ul>
    
</ul></li>
				
			
		</ul>
            </div>
            &nbsp;
          </nav>
        </div>

	<section class="section-sm-41">
		<div class="shell">
		    <div class="range range-xs-right">
		        <div class="cell-xs-10 cell-sm-8 cell-md-9 cell-lg-10 cell-xl-12 text-md-left cell-lg-push-1 offset-lg-top-0">
			  
				<div class="wy-nav-content">
				  <div class="rst-content">
				   
				    <div role="main">
				      <div class="section">
					
					  <div class="range range-xs-left">
<div class="cell-xs-10 cell-lg-6 text-md-left inset-md-right-80 cell-lg-push-1 offset-top-50 offset-lg-top-0">
<h2 id="content" class="h1">Custom monitoring</h2>
<div class="offset-top-30 offset-md-top-50">
</div>
</div>
</div>

<h4 id="custom-monitoring-from-sut" class="holder-subtitle link-top">Custom monitoring from SuT</h4>

<p>You maybe want your Dockerized SuT to send custom metrics to ElasTest appart from those automatically retrieved by our standard monitoring agents. In that case, all techniques used to instrument manually an already deployed SuT can be used in a SuT deployed by ElasTest. Check <a href="../../../docs/monitoring/deployed">Deployed monitoring</a> section.</p>
<h4 class="holder-subtitle link-top">Custom monitoring from tests</h4>

<p>It can be useful to graph some custom information generated in the tests alongside with other metrics. You maybe want to graph some variables of your test, whatever they are. </p>
<p>For example: if your SuT is a web application, your test can send the number of users connecting to it as it executes and you can compare it with the CPU consumption or memory usage of the SuT. For this reason, testers can send to ElasTest any monitoring information they want.</p>
<p>When a TJob is executed, the following environment variables are injected so you can use them in your test code:</p>
<ul>
<li><em><code>ET_MON_LSHTTP_API</code></em>: Logstash API URL to send http requests with monitoring information.  </li>
<li><em><code>ET_MON_EXEC</code></em>: The execution identifier to set the value of <code>exec</code> field. </li>
</ul>
<p>The allowed formats are the same as described for Deployed SuT in <a href="../../../docs/monitoring/deployed#send-metrics-with-http">Send metrics with HTTP</a>, but with the following considerations: </p>
<ul>
<li>Field <strong>exec</strong> must have the value of environment variable <code>ET_MON_EXEC</code>.</li>
<li>Field <strong>component</strong> must contain the value <code>test</code>, because the event is generated in the test.</li>
<li>The URL of the POST request must be the value of environment variable <code>ET_MON_LSHTTP_API</code></li>
</ul>
<p>With these changes, the body of a POST request sending a custom metric with the number of concurrent users would be</p>
<pre><code class="json">{
   &quot;@timestamp&quot;: 9999999999,
   &quot;exec&quot;: &quot;XX&quot;,
   &quot;component&quot;: &quot;test&quot;,
   &quot;type&quot;: &quot;users&quot;,
   &quot;stream_type&quot;: &quot;atomic_metric&quot;,
   &quot;users&quot;: 80,
   &quot;unit&quot;: &quot;users&quot;
}
</code></pre>

<p>"users" can be customized as you want.</p>
<!--<h4 class="holder-subtitle link-top">Custom monitoring from TSS</h4>

Some of the key drivers of ElasTest development is to make life easier to testers. For this reason, [Test Support Services](/#tss) can send custom metrics to ElasTest. For example, when a test is making use of Web Browsers service, the browser console is sent to ElasTest and can be visualized alongside SuT and Test logs.

For every TSS used on a TJob execution, the tester will be able to select all the desired metrics to be shown from a predefined set (different for each TSS).-->
					
				      </div>
				    </div>
				    <footer>
<hr class="divider divider-100 divider-xs hr-lg-center-0 offset-xs-top-20 offset-sm-top-20 offset-md-top-20 offset-lg-top-20">
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../gui/" class="btn btn-xs btn-primary float-right" title="Monitoring user interface">Next &raquo;<span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../deployed/" class="btn btn-xs btn-primary" title="Deployed monitoring"><span class="icon icon-circle-arrow-left"></span> &laquo; Prev</a>
      
    </div>
  


  
  
	  <a href="https://github.com/elastest/elastest.io-docs/blob/master/docs/monitoring/custom.md" class="fa fa-github offset-xxs-top-30"> Edit Documentation on GitHub</a>
  
</footer>
			  	  
				  </div>
				</div>
			</div>
		    </div>
		</div>
	</section>

  </div>
</div>